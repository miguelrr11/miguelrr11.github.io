<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Miguelrr11's p5js Projects</title>

    
    <link rel="stylesheet" href="styles.css">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Victor+Mono:ital,wght@0,100..700;1,100..700&display=swap" rel="stylesheet">
</head>

<body>
 <header>
     <h1>Welcome to Miguel's p5js projects</h1>
 </header>

 <main>
    
    <!-- <h2 class="featured-title">Featured</h2> -->
    <div class="cards-wrapper">
        <a href="Algorithms/Logic_Sim_v3/" class="card">
          <div class="card-image" style="background-image: url('assets/imgsCss/LogicSim.png');"></div>
          <div class="card-title">Digital Logic Sim</div>
        </a>
        <a href="IAs/Smart_Pendulums_V2/" class="card">
          <div class="card-image" style="background-image: url('assets/imgsCss/NeatPendulums.png');"></div>
          <div class="card-title">NEAT Pendulums</div>
        </a>
        <a href="Algorithms/Wave_Function_Collapse_Painter/" class="card">
          <div class="card-image" style="background-image: url('assets/imgsCss/WFCPainter.png');"></div>
          <div class="card-title">Wave Function Collapse Painter</div>
        </a>
        <a href="https://miguelrr11.github.io/tfg_latex_etsiinf-2023.02.20/" class="card">
          <div class="card-image" style="background-image: url('assets/imgsCss/fish.png');"></div>
          <div class="card-title">Lake Ecosystem</div>
        </a>
        <a href="Algorithms/WebViewer/" class="card">
          <div class="card-image" style="background-image: url('assets/imgsCss/WikiGraph.png');"></div>
          <div class="card-title">WikiGraph</div>
        </a>
    </div>

    <button id="toggleShowAll">Show Hidden Items</button>

    <div class="category-cards-wrapper">
     <div class="category-card">
         <h2>Games</h2>
         <ul>
            <li><a href="Games/Particulate/" class="matrix-link ambient-matrix">Particulate</a></li>
            <li><a href="Games/RuneCode/" class="matrix-link ambient-matrix">Rune Code</a></li>
            <li><a href="Games/Tetris/" class="matrix-link ambient-matrix">Tetris</a></li>
            <li><a href="Games/Sudoku/" class="matrix-link ambient-matrix">Sudoku</a></li>
            <li><a href="Games/2048_Game_2024_03_22_19_26_40/" class="matrix-link ambient-matrix">2048</a></li>
            <li><a href="Games/Buscaminas_2024_03_22_19_26_38/" class="matrix-link ambient-matrix">Buscaminas</a></li>
            <li><a href="Games/aa/" class="matrix-link ambient-matrix">aa</a></li>
            <li><a href="Games/Nexus_Attack/" class="matrix-link ambient-matrix">Nexus Attack</a></li>
            <li><a href="Games/Grid_Digger/" class="matrix-link ambient-matrix">Grid Digger</a></li>
            <li><a href="Games/Mini%20Golf/" class="matrix-link ambient-matrix">Mini Golf</a></li>
            <li><a href="Games/One%20More%20Line/" class="matrix-link ambient-matrix">One More Line</a></li>
            <li><a href="Games/Drift/" class="matrix-link ambient-matrix">Drift Playground</a></li>
         </ul>
         <div class="extra-items"  style="display: none;">
            <ul>
              <li><a class="custom-link matrix-link"  href="Games/Snake_2024_03_22_19_27_10/">Snake</a></li>
              <li><a class="custom-link"  href="Games/3_en_raya_2024_03_22_19_27_11/">Tic-Tac-Toe</a></li>
              <li><a class="custom-link"  href="Games/Break_Bricks_2024_03_22_19_26_28/">Break Bricks</a></li>
              <li><a class="custom-link"  href="Games/Flappy_Bird_2024_03_22_19_26_31/">Flappy Bird</a></li>
              <li><a class="custom-link"  href="Games/Ball%20Blast/">Ball Blast</a></li>
              <li><a class="custom-link"  href="Games/Flow_Free_Game_2024_03_22_19_25_04/">Flow Free</a></li>
            </ul>
          </div>
     </div>

     <div class="category-card">
         <h2>Algorithms</h2>
         <ul>
             <li><a href="Algorithms/A_algorithm_2024_03_22_19_26_55/" class="matrix-link ambient-matrix">A* pathfinder visualization</a></li>
             <li><a href="Algorithms/Wave_Function_Collapse_(normal_tiles)_2024_03_22_19_26_53/" class="matrix-link ambient-matrix">Wave Function Collapse (normal tiles)</a></li>
             <li><a href="Algorithms/Marching_Squares/" class="matrix-link ambient-matrix">Marching Squares</a></li>
             <li><a href="Algorithms/BrainFuckViz/" class="matrix-link ambient-matrix">BrainFuckViz</a></li>
             <li><a href="Algorithms/Maze_generator_2024_03_22_19_26_54/" class="matrix-link ambient-matrix">Maze Generator</a></li>
             <li><a href="Algorithms/Self-avoiding_Walk_2024_03_22_19_26_57/" class="matrix-link ambient-matrix">Self Avoiding Walk</a></li>
             <li><a href="Algorithms/Metaballs/" class="matrix-link ambient-matrix">Metaballs & Marching Squares</a></li>
             <li><a href="Algorithms/TBOImapGenerator/" class="matrix-link ambient-matrix">TBOI Procedural Map Generator</a></li>
             <li><a href="Algorithms/FractalDimension/" class="matrix-link ambient-matrix">Fractal Dimension</a></li>
             <li><a href="Algorithms/PID/" class="matrix-link ambient-matrix">PID Controller</a></li>
             

         </ul>
         <div class="extra-items" style="display: none;">
            <ul>
                <li><a class="custom-link"  href="Algorithms/Bubble_Sort_Visualization_2024_03_22_19_27_06/">Bubble Sort visualization</a></li>
                <li><a class="custom-link"  href="Algorithms/KD_tree/">KD Tree visualization</a></li>
                <li><a class="custom-link"  href="Algorithms/Rippling_Water/">Rippling Water</a></li>
                <li><a class="custom-link"  href="Algorithms/Wave_Function_Collapse_(coloured_tiles)_2024_03_22_19_26_52/">Wave Function Collapse (coloured tiles)</a></li>
                <li><a class="custom-link"  href="Algorithms/Wave_Function_Collapse_(Island)_2024_03_22_19_26_51/">Wave Function Collapse (islands)</a></li>
                <li><a class="custom-link"  href="Algorithms/Lineas_Topograficas/">Topographic Lines</a></li>
                <li><a class="custom-link"  href="Algorithms/Voronoi/">Voronoi Diagram</a></li>
                <li><a class="custom-link"  href="Algorithms/TSP/">Travalling Salesman Problem Brute Force</a></li>
                <li><a class="custom-link"  href="Algorithms/Music_And_Lyrics_Visualizer/">Music Visualizer & Spotify Lyrics</a></li>
                <li><a class="custom-link"  href="Algorithms/DLA/">DLA</a></li>
                <li><a class="custom-link"  href="Algorithms/CreaturesAnimation/">Creatures Animation</a></li>
                <li><a class="custom-link"  href="Algorithms/SoftBodyCreator/">Soft Body Creator</a></li>
            </ul>
          </div>
     </div>

     <div class="category-card">
        <h2>Utilities</h2>
        <ul>
            <li><a href="Algorithms/Logic_Sim_v3/" class="matrix-link ambient-matrix">Digital Logic Sim</a></li>
            <li><a href="Algorithms/Wave_Function_Collapse_Painter/" class="matrix-link ambient-matrix">Wave Function Collapse Painter</a></li>
            <li><a href="Algorithms/WebViewer/" class="matrix-link ambient-matrix">WikiGraph</a></li>
            <li><a href="Math/Mathematical_Evaluator/" class="matrix-link ambient-matrix">Graphing Calculator</a></li>
            <li><a href="Algorithms/Enigma/" class="matrix-link ambient-matrix">Enigma Machine</a></li>
            <li><a href="Algorithms/L_System_Renderer/" class="matrix-link ambient-matrix">L-System Renderer</a></li>
            <li><a href="Algorithms/Easy_Animation/" class="matrix-link ambient-matrix">Easy Animation</a></li> 
            <li><a href="Algorithms/TODOs/" class="matrix-link ambient-matrix">TODOs</a></li> 
            <li><a href="Algorithms/NoHitManager/" class="matrix-link ambient-matrix">NoHit Manager</a></li>
            <li><a href="Algorithms/Music_Visualizer/" class="matrix-link ambient-matrix">Music Visualizer</a></li>
            <li><a href="Miscellaneous/SmoothTextEditor/" class="matrix-link ambient-matrix">Smooth Text Editor</a></li>
            <li><a href="Algorithms/Ascii_Camera/" class="matrix-link ambient-matrix">ASCII Camera</a></li>
        </ul>
    </div>

     <div class="category-card">
         <h2>Cellular Automatas</h2>
         <ul>
            <li><a href="Automatas/Particle_Lenia/" class="matrix-link ambient-matrix">Particle Lenia</a></li>
            <li><a href="Automatas/Hex_CA/" class="matrix-link ambient-matrix">Hexagonal Cellular Automata</a></li>
            <li><a href="Automatas/Multiple_Neighbours_CA/" class="matrix-link ambient-matrix">Multiple Neighbours Cellular Automata</a></li>
            <li><a href="Automatas/MNCA_Circles/" class="matrix-link ambient-matrix">MNCA Circular Neighbourhoods</a></li>
            <li><a href="Automatas/Smooth_Life/" class="matrix-link ambient-matrix">Smooth Life</a></li>
            <li><a href="Automatas/Game_of_Life_2024_03_22_19_27_16/" class="matrix-link ambient-matrix">Game Of Life</a></li>
            <li><a href="Automatas/Langtons_Loop/" class="matrix-link ambient-matrix">Langton's Loop</a></li>
            <li><a href="Automatas/Brian's_Brain_2024_03_22_19_27_13/" class="matrix-link ambient-matrix">Brian's Brain</a></li>
            <li><a href="Automatas/1-D_Cellular_Automata_2024_03_22_19_27_12/" class="matrix-link ambient-matrix">1D Cellular Automata</a></li>
         </ul>
         <div class="extra-items" style="display: none;">
            <ul>
                <li><a class="custom-link"  href="Automatas/Hormiga_de_Langton_2024_03_22_19_27_15/">Langton's Ant</a></li>
            </ul>
          </div>
     </div>

     <div class="category-card">
         <h2>AI</h2>
         <ul>
            <li><a href="IAs/Smart_Pendulums_V2/" class="matrix-link ambient-matrix">NEAT Pendulums</a></li>
            <li><a href="IAs/Smart_Cars/" class="matrix-link ambient-matrix">Smart Cars</a></li>
            <li><a href="IAs/Smart_Cars%20v2/" class="matrix-link ambient-matrix">Smart Cars v2</a></li>
            <li><a href="IAs/Smart_Cars%20v3/" class="matrix-link ambient-matrix">Smart Cars v3</a></li>
            <li><a href="IAs/Smart_Cars%20v4/" class="matrix-link ambient-matrix">Smart Cars v4</a></li>
             <li><a href="IAs/Smart_Birds/" class="matrix-link ambient-matrix">Smart Birds</a></li>
             <li><a href="IAs/Smart_Snakes/" class="matrix-link ambient-matrix">Smart Snakes</a></li>
             <li><a href="IAs/TSP_GA/" class="matrix-link ambient-matrix">Travelling Salesman Problem GA</a></li>
             <li><a href="IAs/Smart_Double_Pendulums/" class="matrix-link ambient-matrix">NEAT Double Pendulums</a></li>
         </ul>
         <div class="extra-items" style="display: none;">
            <ul>
                <li><a class="custom-link"  href="IAs/Smart_Rockets_(natural_selection)_2024_03_24_10_51_08/">Smart Rockets</a></li> 
                <li><a class="custom-link"  href="IAs/Smart_SpaceShips/">NEAT Space Ships</a></li>
            </ul>
          </div>
     </div>

     <div class="category-card">
         <h2>Math</h2>
         <ul>
            <li><a href="Math/Splines/" class="matrix-link ambient-matrix">Splines</a></li>
            <li><a href="Math/TorusKnot/" class="matrix-link ambient-matrix">Torus Knot</a></li>
            <li><a href="Math/Curves_table_Lissajous/" class="matrix-link ambient-matrix">Lissajous Curves Table</a></li>
            <li><a href="Math/Fourier_Series/" class="matrix-link ambient-matrix">Fourier Series</a></li>
            <li><a href="Math/Montecarlo's_Pi_Estimation_2024_03_22_19_27_07/" class="matrix-link ambient-matrix">Montecarlo's Pi Estimation</a></li>
            <li><a href="Math/Inverse_Kinematics/" class="matrix-link ambient-matrix">Inverse Kinematics</a></li>
            <li><a href="Math/3d_Cube_Projection/" class="matrix-link ambient-matrix">3D Cube Projection and Rotation in 2D</a></li>
            <li><a href="Math/3d_Sphere_Projection/" class="matrix-link ambient-matrix">3D Sphere Projection and Rotation in 2D</a></li>
         </ul>
         <div class="extra-items" style="display: none;">
            <ul>
                <li><a class="custom-link"  href="Math/CoolerBezier/">Cubic Bezier Animated</a></li>
                <li><a class="custom-link"  href="Math/CubicBezierSpline/">Cubic Bezier Spline</a></li>
                <li><a class="custom-link"  href="Math/HermiteSpline/">Hermite Spline</a></li>
                <li><a class="custom-link"  href="Math/Bezier/">Bezier curve</a></li>
                <li><a class="custom-link"  href="Math/Delaunay_Triangulation/">Delaunay Triangulation</a></li>
                <li><a class="custom-link"  href="Math/Bezier_cubic/">Bezier cubic curve</a></li>
            </ul>
          </div>
     </div>

     <div class="category-card">
         <h2>Simulations</h2>
         <ul>
            <li><a href="https://miguelrr11.github.io/tfg_latex_etsiinf-2023.02.20/" class="matrix-link ambient-matrix">Lake Ecosystem</a></li>
            <li><a href="IAs/Ovejas_VS_Lobos/" class="matrix-link ambient-matrix">Sheep VS Foxes</a></li>
            <li><a href="Physics_Simulations/RT_Fluid_Dynamics/" class="matrix-link ambient-matrix">RT Fluid Dynamics (cell based)</a></li>
            <li><a href="Physics_Simulations/EvoPlant/" class="matrix-link ambient-matrix">EvoPlant</a></li>
             <li><a href="Physics_Simulations/Particle_Life/" class="matrix-link ambient-matrix">Particle Life</a></li>
             <li><a href="Physics_Simulations/Ant_Sim/" class="matrix-link ambient-matrix">Ant Sim</a></li>
             <li><a href="Physics_Simulations/Slime_Mold/" class="matrix-link ambient-matrix">Slime Mold</a></li>
             <li><a href="Physics_Simulations/Flocking_Boids/" class="matrix-link ambient-matrix">Flocking Sim - Boids v2</a></li>
             <li><a href="Physics_Simulations/Path_Following/" class="matrix-link ambient-matrix">Path Following Agents</a></li>
             <li><a href="Physics_Simulations/Cloth_Sim/" class="matrix-link ambient-matrix">Cloth Sim</a></li>
             <li><a href="Physics_Simulations/Noise_Flow_Field/" class="matrix-link ambient-matrix">Perlin Noise Flow Field</a></li>
             <li><a href="Physics_Simulations/Black_hole_visualizer_2024_03_22_19_27_00/" class="matrix-link ambient-matrix">Black Hole</a></li>
             <li><a href="Physics_Simulations/CirclesColliding/" class="matrix-link ambient-matrix">Circles Colliding</a></li>
             <li><a href="Physics_Simulations/Double_Pendulum_2024_03_22_19_27_01/" class="matrix-link ambient-matrix">Double Pendulum</a></li>
             <li><a href="Physics_Simulations/FLIP/" class="matrix-link ambient-matrix">FLIP</a></li>
             <li><a href="Physics_Simulations/Plant_Generator/" class="matrix-link ambient-matrix">Plant Generator</a></li>
         </ul>
         <div class="extra-items" style="display: none;">
            <ul>
                <li><a class="custom-link"  href="Physics_Simulations/Paper_Rock_Scissors/">Paper Rock Scissors Battle</a></li>
                <li><a class="custom-link"  href="Physics_Simulations/Falling_Sand_2024_03_22_19_27_09/">Falling Sand</a></li>
                <li><a class="custom-link"  href="Physics_Simulations/Flocking_Sim_-_Boids_v1_2024_03_22_19_26_36/">Flocking Sim - Boids</a></li>
                <li><a class="custom-link"  href="Physics_Simulations/Reaction_Diffusion_2024_03_22_19_26_44/">Reaction Diffusion</a></li>
                <li><a class="custom-link"  href="Physics_Simulations/Element_Pixel/">Element Pixel</a></li>
            </ul>
          </div>
     </div>

     <div class="category-card">
         <h2>WebGL</h2>
         <ul>
             <li><a href="WebGL/Fractal_Noise/" class="matrix-link ambient-matrix">Fractal Noise</a></li>
             <li><a href="WebGL/Voronoi_Diagram/" class="matrix-link ambient-matrix">Voronoi Diagram</a></li>
             <li><a href="WebGL/Gravity_Basins/" class="matrix-link ambient-matrix">Gravity Basins</a></li>
             <li><a href="WebGL/Mandelbrot_Set/" class="matrix-link ambient-matrix">Mandelbrot Set</a></li>
             <li><a href="Miscellaneous/GameOfLifeWEBGL/" class="matrix-link ambient-matrix">Game of Life</a></li>
             <!-- <li><a href="WebGL/SmoothLifeWebGL/">SmoothLife</a></li> -->
         </ul>
         <div class="extra-items" style="display: none;">
            <ul>
                
            </ul>
          </div>
     </div>

     <div class="category-card">
         <h2>Miscellaneous</h2>
         <ul>
             <li><a href="Physics_Simulations/Wallpaper_Generator_Noise_Flow_Field/" class="matrix-link ambient-matrix">Wallpaper Generator Noise Flow Field</a></li>
             <li><a href="Algorithms/Markov_Poetry/" class="matrix-link ambient-matrix">Markov Don Quijote</a></li>
             <li><a href="Miscellaneous/2D_Ray-Casting_2024_03_22_19_27_08/" class="matrix-link ambient-matrix">2D Ray-Casting</a></li>
             <li><a href="Miscellaneous/Discontinued_Lines_%26_Circle_Intersection/" class="matrix-link ambient-matrix">Discontinued Lines & Circle Intersection</a></li>
             <li><a href="Miscellaneous/prueba_game_orbit/" class="matrix-link ambient-matrix">Prueba Game Orbit</a></li>
             <li><a href="Miscellaneous/rain%3Awind effect/" class="matrix-link ambient-matrix">Rain/Wind effect</a></li>
             <li><a href="Miscellaneous/levelMaker/" class="matrix-link ambient-matrix">Level Maker (created for Mini Golf)</a></li>
             <li><a href="Miscellaneous/migUIDemo/" class="matrix-link ambient-matrix">migUI Demo</a></li>
             <li><a href="Miscellaneous/migPLOT/" class="matrix-link ambient-matrix">migPLOT Demo</a></li>
             <li><a href="Miscellaneous/pruebaTextPoints/" class="matrix-link ambient-matrix">pruebaTextPoints</a></li>
             <li><a href="Miscellaneous/orbitRecursive/" class="matrix-link ambient-matrix">orbitRecursive</a></li>
             <li><a href="Miscellaneous/noiseValley/" class="matrix-link ambient-matrix">Gradient Descent</a></li>
             <li><a href="Miscellaneous/LoadDemo/" class="matrix-link ambient-matrix">Load Demo</a></li>
             <li><a href="Miscellaneous/CoolTextAnim/" class="matrix-link ambient-matrix">Cool Text Animations</a></li>
         </ul>
         <div class="extra-items" style="display: none;">
            <ul>
                <li><a class="custom-link"  href="Miscellaneous/Continuous%20Circle/">Continuous Circle</a></li>
                <li><a class="custom-link"  href="Miscellaneous/simply5/">Simply5</a></li>
                <li><a class="custom-link"  href="Miscellaneous/pruebaTouchScreen/">pruebaTouchScreen</a></li>
            </ul>
          </div>
     </div>

     <div class="category-card">
         <h2>Github Repository Link</h2>
         <ul>
             <li><a href="https://github.com/miguelrr11/miguelrr11.github.io" class="matrix-link ambient-matrix">Repository</a></li>
         </ul>
     </div>

    </div>

 </main>

 <footer>
     <p>2025 -  Miguel Rodríguez</p>
 </footer>
</body>

<script>
    document.getElementById('toggleShowAll').addEventListener('click', function() {
        var hiddenItems = document.querySelectorAll('.extra-items');
        var isHidden = Array.from(hiddenItems).every(div => div.style.display === 'none' || div.style.display === '');
        
        hiddenItems.forEach(div => {
            div.style.display = isHidden ? 'block' : 'none';
        });
    
        this.textContent = isHidden ? 'Hide Hidden Items' : 'Show Hidden Items';
    });
    
</script>

<script>
(() => {
  const GLYPHS = "0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ!@#$%^&*()_+-=<>?/\\[]{}";
  const prefersReduced = window.matchMedia("(prefers-reduced-motion: reduce)").matches;

  function splitIntoSpans(el) {
    if (el._spanned) return;
    const text = el.textContent;
    el.textContent = "";
    [...text].forEach((ch, i) => {
        const span = document.createElement("span");
        if (ch === " ") {
        span.textContent = "\u00A0";   // NBSP preserves width
        span.dataset.space = "1";      // mark as a space
        } else {
        span.textContent = ch;
        }
        span.dataset.i = i;
        el.appendChild(span);
    });
    el.dataset.original = text; // keep the original (with regular spaces)
    el._spanned = true;
    }



  function setTextFromString(el, str) {
    const spans = el.querySelectorAll("span");
    const len = Math.min(spans.length, str.length);
    for (let i = 0; i < len; i++) {
      const s = spans[i];
      if (s.dataset.space === "1") continue;        // never touch spaces
      const ch = str[i] === " " ? "\u00A0" : str[i]; // normalize if needed
      s.textContent = ch;
    }
  }


  function randomString(len, isSpaceAt) {
    let out = "";
    for (let i = 0; i < len; i++) {
        if (isSpaceAt(i)) {
        out += "\u00A0";               // keep NBSP
        } else {
        out += GLYPHS[(Math.random() * GLYPHS.length) | 0];
        }
    }
    return out;
  }


  function startScramble(el) {
    if (el._scrambling) return;
    splitIntoSpans(el);

    const spans = el.querySelectorAll("span");
    const len = spans.length;
    const isSpaceAt = (i) => spans[i]?.dataset.space === "1";

    el._scrambling = true;

    const tick = (t) => {
      if (!el._scrambling) return;
      const scrambled = randomString(len, isSpaceAt);
      setTextFromString(el, scrambled);
      el._scrambleRAF = requestAnimationFrame(tick);
    };

    el._scrambleRAF = requestAnimationFrame(tick);

    // stopper with reveal that also respects spaces
    return () => {
      el._scrambling = false;
      cancelAnimationFrame(el._scrambleRAF);

      const original = el.dataset.original || "";
      const steps = 18;
      let k = 0;

      const reveal = () => {
        const revealCount = Math.floor((k / steps) * len);
        const head = original.slice(0, revealCount).replace(/ /g, "\u00A0");
        const tail = randomString(Math.max(0, len - revealCount), (i) => isSpaceAt(i + revealCount));
        // write head + tail while skipping spaces inside setTextFromString
        setTextFromString(el, head + tail);

        k++;
        if (k <= steps) {
          el._revealRAF = requestAnimationFrame(reveal);
        } else {
          // final: write the true original while preserving NBSP in spans
          const finalStr = original.replace(/ /g, "\u00A0");
          setTextFromString(el, finalStr);
        }
      };

      el._revealRAF = requestAnimationFrame(reveal);
    };
  }

  function stopScramble(el) {
    if (typeof el._stopScramble === "function") {
      el._stopScramble();
      el._stopScramble = null;
    }
  }

  function bindMatrixLinks(root = document) {
    const links = root.querySelectorAll("a.matrix-link");
    links.forEach((el) => {
      if (el._matrixBound) return;
      el._matrixBound = true;

      splitIntoSpans(el);

      el.addEventListener("mouseenter", () => {
        el._stopScramble = startScramble(el);
      });
      el.addEventListener("mouseleave", () => {
        stopScramble(el);
      });

      // Keyboard users
      el.addEventListener("focus", () => {
        el._stopScramble = startScramble(el);
      });
      el.addEventListener("blur", () => {
        stopScramble(el);
      });
    });
  }

  if (document.readyState === "loading") {
    document.addEventListener("DOMContentLoaded", () => bindMatrixLinks());
  } else {
    bindMatrixLinks();
  }

  // Expose for dynamically-added links
  window.MatrixLinks = { bind: bindMatrixLinks };
})();
</script>

<script>
(() => {
  const prefersReduced = window.matchMedia("(prefers-reduced-motion: reduce)").matches;

  // If your hover-scramble code already did span-wrapping, this will detect and skip.
  function splitIntoSpans(el) {
    if (el._spanned) return;
    // If it already contains spans, assume someone else wrapped it.
    if (el.querySelector("span")) { el._spanned = true; return; }

    const text = el.textContent;
    el.textContent = "";
    for (const ch of [...text]) {
      const span = document.createElement("span");
      span.textContent = ch;
      el.appendChild(span);
    }
    el._spanned = true;
  }

  function randomInt(min, max) {
    return Math.floor(Math.random() * (max - min + 1)) + min;
  }

  // Start a gentle loop for a single link element
  function startAmbient(el) {
    if (prefersReduced || el._ambientOn) return;
    splitIntoSpans(el);
    el._ambientOn = true;

    const spans = () => el.querySelectorAll("span");
    const minDelay = 1200;  // ms between flickers
    const maxDelay = 2600;  // vary timing so it feels organic

    let timer;
    let paused = false;

    function scheduleNext() {
      if (!el._ambientOn || paused) return;
      const delay = randomInt(minDelay, maxDelay);
      timer = setTimeout(() => {
        if (!el._ambientOn || paused) return;

        const s = spans();
        if (s.length === 0) { scheduleNext(); return; }

        // Flicker 1–2 random characters (usually 1)
        const count = Math.random() < 0.25 ? 2 : 1;
        const chosen = new Set();
        for (let k = 0; k < count; k++) {
          let idx = randomInt(0, s.length - 1);
          while (chosen.has(idx) && chosen.size < s.length) {
            idx = randomInt(0, s.length - 1);
          }
          chosen.add(idx);
        }

        chosen.forEach(i => {
          const span = s[i];
          if (!span) return;
          // If it’s already flickering, skip to avoid stacking animations
          if (span.classList.contains("is-flickering")) return;

          span.classList.add("is-flickering");
          span.addEventListener("animationend", function handler() {
            span.classList.remove("is-flickering");
            span.removeEventListener("animationend", handler);
          });
        });

        scheduleNext(); // chain
      }, delay);
    }

    // Pause when tab is hidden to save work
    function onVisChange() {
      paused = document.hidden;
      if (!paused) scheduleNext();
      else clearTimeout(timer);
    }
    document.addEventListener("visibilitychange", onVisChange);

    // Store cleaners so we can stop later if needed
    el._ambientCleanup = () => {
      clearTimeout(timer);
      document.removeEventListener("visibilitychange", onVisChange);
      el._ambientOn = false;
    };

    scheduleNext();
  }

  function stopAmbient(el) {
    if (el._ambientCleanup) {
      el._ambientCleanup();
      el._ambientCleanup = null;
    }
  }

  function bindAmbient(root = document) {
    root.querySelectorAll("a.ambient-matrix").forEach(el => {
      if (el._ambientBound) return;
      el._ambientBound = true;
      startAmbient(el);
    });
  }

  if (document.readyState === "loading") {
    document.addEventListener("DOMContentLoaded", () => bindAmbient());
  } else {
    bindAmbient();
  }

  // Expose tiny API if you inject links later
  window.AmbientMatrix = { bind: bindAmbient, start: startAmbient, stop: stopAmbient };
})();
</script>

<script>
(() => {
  const GLYPHS = "アカサタナハマヤラワ0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ!@#$%^&*()_+-=<>?/\\[]{}";

  // --- helpers ---
  const isSpaceSpan = s => s.dataset.space === "1";

  function splitIntoSpans(el) {
    if (el._spanned) return;
    const text = el.textContent;
    el.dataset.original = text;       // keep plain-text original
    el.textContent = "";
    for (const ch of [...text]) {
      const span = document.createElement("span");
      if (ch === " ") {
        span.textContent = "\u00A0";  // NBSP
        span.dataset.space = "1";
      } else {
        span.textContent = ch;
      }
      el.appendChild(span);
    }
    el._spanned = true;
  }

  function restoreOriginal(el) {
    const orig = (el.dataset.original || "").replace(/ /g, "\u00A0");
    const spans = el.querySelectorAll("span");
    if (!spans.length) { el.textContent = orig.replace(/\u00A0/g, " "); return; }
    const chars = [...orig];
    for (let i = 0; i < spans.length; i++) {
      if (isSpaceSpan(spans[i])) continue;
      spans[i].textContent = chars[i] || "";
      spans[i].style.opacity = ""; // clear any fading
    }
  }

  // --- hover scramble ---
  function startScramble(el) {
    if (el._scrambling) return;
    splitIntoSpans(el);
    el._scrambling = true;

    const spans = el.querySelectorAll("span");

    const tick = () => {
      if (!el._scrambling) return;
      for (let i = 0; i < spans.length; i++) {
        const s = spans[i];
        if (isSpaceSpan(s)) continue;
        s.textContent = GLYPHS[(Math.random() * GLYPHS.length) | 0];
      }
      el._raf = requestAnimationFrame(tick);
    };
    el._raf = requestAnimationFrame(tick);
  }

  function stopScramble(el, restore = true) {
    el._scrambling = false;
    if (el._raf) cancelAnimationFrame(el._raf);
    el._raf = null;
    if (restore) restoreOriginal(el);
  }

  // --- bind once ---
  function bindMatrixLinks(root = document) {
    root.querySelectorAll("a.matrix-link").forEach(el => {
      if (el._bound) return;
      el._bound = true;

      el.addEventListener("mouseenter", () => startScramble(el));
      el.addEventListener("focus", () => startScramble(el));

      const stop = () => stopScramble(el, true);
      el.addEventListener("mouseleave", stop);
      el.addEventListener("blur", stop);
      el.addEventListener("click", stop); // ensure stop even if mouseleave doesn't fire
    });
  }

  // reset on load + bfcache restore so nothing stays scrambled
  function resetAll() {
    document.querySelectorAll("a.matrix-link").forEach(el => stopScramble(el, true));
  }

  if (document.readyState === "loading") {
    document.addEventListener("DOMContentLoaded", () => { bindMatrixLinks(); resetAll(); });
  } else {
    bindMatrixLinks(); resetAll();
  }

  window.addEventListener("pageshow", (e) => { if (e.persisted) resetAll(); });
})();
</script>




</html>